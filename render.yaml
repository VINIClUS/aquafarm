services:
  - type: web
    name: aquafarm
    env: ruby
    plan: free
    autoDeploy: true
    buildCommand: ./bin/render-build.sh
    startCommand: bundle exec puma -C config/puma.rb
    healthCheckPath: /up

    envVars:
      # Defina estes dois no painel do Render (Secrets). NÃO faça commit de valores.
      - key: DATABASE_URL          # Ex.: Postgres do Supabase/Neon
        value: psql 'postgresql://neondb_owner:npg_g7wByxpvON3F@ep-shiny-tree-ackmxdcb-pooler.sa-east-1.aws.neon.tech/neondb?sslmode=require&channel_binding=require'
        sync: false
      - key: RAILS_MASTER_KEY      # Conteúdo de config/master.key
        value: ace710391b760f9256851383f0291054
        sync: false

      # Se você NÃO guarda secret_key_base em credentials/rails, defina aqui também:
      # - key: SECRET_KEY_BASE
      #   sync: false

      # Ajustes recomendados p/ plano free
      - key: WEB_CONCURRENCY
        value: "2"
      - key: RAILS_LOG_TO_STDOUT
        value: "true"
      - key: RAILS_SERVE_STATIC_FILES
        value: "true"

      # Opcional: rode seeds apenas uma vez
      # - key: RUN_SEEDS
      #   value: "true"
